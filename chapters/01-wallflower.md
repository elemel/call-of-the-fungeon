# Chapter 1: Wallflower

You have entered a dungeon. You stand at the bottom of the staircase where you entered, facing east. A gnomish cartographer, carrying a bundle of scrolls, peers at you from an adjacent tile. As he steps onto the staircase, he thrusts a scroll into your hands. Before you can respond, he has already left the dungeon.

Unrolling the scroll, you identify it as a magic map. It ripples and shifts into a symbolic representation of the dungeon:

```
######][#####[###[#######][##########################]####]###]##########][##]##
#####[..[[[...[...[####][..[#[####################][#....].]#[....]###[....[#.]#
#####]....#.]...]..[###.].....###################]....[....[##.##]###[........[#
####[..[.....]...]..#]]...]#[.######]#[############.]##[]#.....[######[]#.][#..]
#####.]#[.#].#][]...[....]....[####]...]########]#]...]#.][[##.#########]...[[.#
#####.###.##.]....][....]##[...#]#[##].....]#]#[.]##.]#]....][<.]####]##...][..#
#####.][#.#[.##.[.[#..[]####.].....[....]#]#]....[[#.[....]...[..]##[.......].]#
#[......[....[]..[##[.###[...[##.[...#]....]]#[....[.#[#].[[.....[#]#.#].#.]...]
[..[...[].[...[]..[....]##[#]#[....]][##.#]#....[###.##[...[.[#[]][...[..].[#].#
#.]#.]..#]#.[][#]..[#].[#######..#]....].###.[#......[##.[##[###]...[.#..[[##[.#
#.##..].###[[....]..[...[####[...]]#[....]#]..][[##[......]####[........[###[..#
#..][.#.#####..#.#]...[[######[].[....[#.#]#[....[##[###]..][.......]]######]..#
#[.[....[##[]..[..]]..[.[####]##]#.#.#[].].....[##]######[..][#..[..#########.]#
[...[]#[.#[.#]..[.#]#]]..][#]...]#.[...]]..[]..]##.]#][###[...].[#..[#######]..]
#.[####]....[...].#...][.[.[..[..][].].....]#[]##].....[###.....][...[#####]...[
#...]###[#....].[...].##.]...[#[..]..[].#.]#####[..#[...[....[#.[#.[####[####].#
#[...]##][.[#.[[#[#.#....[[.[###[.##]#..[.#####[..][].#.#[#]#[#[#[[......[#[...#
##.[]##]...[#[#####.[[##..]..##[..........[#[.......[][.......[...#.###]..[..#]#
##........[########[####[....[##[]###]...........[####].##].....]...####]...]###
##[######################[###################[##]######]#######]###]#######]####
```

The directions on the map are right for east, down for south, left for west, and up for north.

You discover a small contraption wrapped inside the map: a hypnotic timepiece, heavy for its size. After each tick of the clockwork, you are compelled to step forward if possible, and to turn only when instructed. Stepping onto floor tiles (marked `.` on the map) has no particular effect. You slip the timepiece into a pocket on your vest.

The dungeon contains wall tiles: left-turners (marked `[`), right-turners (marked `]`), and halters (marked `#`). Whenever you would step onto a wall tile, stay in front of the wall and turn in place. This still counts as a tick. For a left-turner, turn 90 degrees to the left. For a right-turner, turn 90 degrees to the right. For a halter, turn 0 degrees, in effect halting indefinitely.

As demonstrated by the gnome, you leave the dungeon by stepping onto the staircase (marked `<`) from an adjacent tile. After how many ticks do you leave the dungeon?


## Example

Consider an example dungeon:

```
#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########
```

The log below shows you walking through the example dungeon. On the map, your location is marked with `@`. The status lines show your direction (`Dx: ...`), coordinates (`Co: ...`), and tick count (`T: ...`). The coordinates are shown as `(x, y)`.

```
#############[####]#
#]#[..........#]##.]
[.......@]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (8, 2)
T: 0

---

#############[####]#
#]#[..........#]##.]
[.......@]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: South  Co: (8, 2)
T: 1

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[..@.......[#]#
#]##]#[#]###########

Dx: South  Co: (8, 3)
T: 2

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[..@.......[#]#
#]##]#[#]###########

Dx: West  Co: (8, 3)
T: 3

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[.@........[#]#
#]##]#[#]###########

Dx: West  Co: (7, 3)
T: 4

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[@.........[#]#
#]##]#[#]###########

Dx: West  Co: (6, 3)
T: 5

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[@.........[#]#
#]##]#[#]###########

Dx: South  Co: (6, 3)
T: 6

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[@.........[#]#
#]##]#[#]###########

Dx: East  Co: (6, 3)
T: 7

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[.@........[#]#
#]##]#[#]###########

Dx: East  Co: (7, 3)
T: 8

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[..@.......[#]#
#]##]#[#]###########

Dx: East  Co: (8, 3)
T: 9

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[...@......[#]#
#]##]#[#]###########

Dx: East  Co: (9, 3)
T: 10

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[....@.....[#]#
#]##]#[#]###########

Dx: East  Co: (10, 3)
T: 11

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[.....@....[#]#
#]##]#[#]###########

Dx: East  Co: (11, 3)
T: 12

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[......@...[#]#
#]##]#[#]###########

Dx: East  Co: (12, 3)
T: 13

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[.......@..[#]#
#]##]#[#]###########

Dx: East  Co: (13, 3)
T: 14

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[........@.[#]#
#]##]#[#]###########

Dx: East  Co: (14, 3)
T: 15

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[.........@[#]#
#]##]#[#]###########

Dx: East  Co: (15, 3)
T: 16

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]..[.........@[#]#
#]##]#[#]###########

Dx: North  Co: (15, 3)
T: 17

---

#############[####]#
#]#[..........#]##.]
[.......<]##]..@...[
].]..[..........[#]#
#]##]#[#]###########

Dx: North  Co: (15, 2)
T: 18

---

#############[####]#
#]#[..........#]##.]
[.......<]##]..@...[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (15, 2)
T: 19

---

#############[####]#
#]#[..........#]##.]
[.......<]##]...@..[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (16, 2)
T: 20

---

#############[####]#
#]#[..........#]##.]
[.......<]##]....@.[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (17, 2)
T: 21

---

#############[####]#
#]#[..........#]##.]
[.......<]##].....@[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (18, 2)
T: 22

---

#############[####]#
#]#[..........#]##.]
[.......<]##].....@[
].]..[..........[#]#
#]##]#[#]###########

Dx: North  Co: (18, 2)
T: 23

---

#############[####]#
#]#[..........#]##@]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: North  Co: (18, 1)
T: 24

---

#############[####]#
#]#[..........#]##@]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (18, 1)
T: 25

---

#############[####]#
#]#[..........#]##@]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: South  Co: (18, 1)
T: 26

---

#############[####]#
#]#[..........#]##.]
[.......<]##].....@[
].]..[..........[#]#
#]##]#[#]###########

Dx: South  Co: (18, 2)
T: 27

---

#############[####]#
#]#[..........#]##.]
[.......<]##].....@[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (18, 2)
T: 28

---

#############[####]#
#]#[..........#]##.]
[.......<]##]....@.[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (17, 2)
T: 29

---

#############[####]#
#]#[..........#]##.]
[.......<]##]...@..[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (16, 2)
T: 30

---

#############[####]#
#]#[..........#]##.]
[.......<]##]..@...[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (15, 2)
T: 31

---

#############[####]#
#]#[..........#]##.]
[.......<]##].@....[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (14, 2)
T: 32

---

#############[####]#
#]#[..........#]##.]
[.......<]##]@.....[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (13, 2)
T: 33

---

#############[####]#
#]#[..........#]##.]
[.......<]##]@.....[
].]..[..........[#]#
#]##]#[#]###########

Dx: North  Co: (13, 2)
T: 34

---

#############[####]#
#]#[.........@#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: North  Co: (13, 1)
T: 35

---

#############[####]#
#]#[.........@#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (13, 1)
T: 36

---

#############[####]#
#]#[........@.#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (12, 1)
T: 37

---

#############[####]#
#]#[.......@..#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (11, 1)
T: 38

---

#############[####]#
#]#[......@...#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (10, 1)
T: 39

---

#############[####]#
#]#[.....@....#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (9, 1)
T: 40

---

#############[####]#
#]#[....@.....#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (8, 1)
T: 41

---

#############[####]#
#]#[...@......#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (7, 1)
T: 42

---

#############[####]#
#]#[..@.......#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (6, 1)
T: 43

---

#############[####]#
#]#[.@........#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (5, 1)
T: 44

---

#############[####]#
#]#[@.........#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (4, 1)
T: 45

---

#############[####]#
#]#[@.........#]##.]
[.......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: South  Co: (4, 1)
T: 46

---

#############[####]#
#]#[..........#]##.]
[...@...<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: South  Co: (4, 2)
T: 47

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].].@[..........[#]#
#]##]#[#]###########

Dx: South  Co: (4, 3)
T: 48

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].].@[..........[#]#
#]##]#[#]###########

Dx: West  Co: (4, 3)
T: 49

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]@.[..........[#]#
#]##]#[#]###########

Dx: West  Co: (3, 3)
T: 50

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
].]@.[..........[#]#
#]##]#[#]###########

Dx: North  Co: (3, 3)
T: 51

---

#############[####]#
#]#[..........#]##.]
[..@....<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: North  Co: (3, 2)
T: 52

---

#############[####]#
#]#[..........#]##.]
[..@....<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (3, 2)
T: 53

---

#############[####]#
#]#[..........#]##.]
[.@.....<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (2, 2)
T: 54

---

#############[####]#
#]#[..........#]##.]
[@......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (1, 2)
T: 55

---

#############[####]#
#]#[..........#]##.]
[@......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: South  Co: (1, 2)
T: 56

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
]@]..[..........[#]#
#]##]#[#]###########

Dx: South  Co: (1, 3)
T: 57

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
]@]..[..........[#]#
#]##]#[#]###########

Dx: West  Co: (1, 3)
T: 58

---

#############[####]#
#]#[..........#]##.]
[.......<]##]......[
]@]..[..........[#]#
#]##]#[#]###########

Dx: North  Co: (1, 3)
T: 59

---

#############[####]#
#]#[..........#]##.]
[@......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: North  Co: (1, 2)
T: 60

---

#############[####]#
#]#[..........#]##.]
[@......<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (1, 2)
T: 61

---

#############[####]#
#]#[..........#]##.]
[.@.....<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (2, 2)
T: 62

---

#############[####]#
#]#[..........#]##.]
[..@....<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (3, 2)
T: 63

---

#############[####]#
#]#[..........#]##.]
[...@...<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (4, 2)
T: 64

---

#############[####]#
#]#[..........#]##.]
[....@..<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (5, 2)
T: 65

---

#############[####]#
#]#[..........#]##.]
[.....@.<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (6, 2)
T: 66

---

#############[####]#
#]#[..........#]##.]
[......@<]##]......[
].]..[..........[#]#
#]##]#[#]###########

Dx: East  Co: (7, 2)
T: 67

---

T: 68
```

You leave the example dungeon after 68 ticks.
